# –ê–Ω–∞–ª–∏–∑ —Ç–µ–∫—É—â–µ–≥–æ –º–∞—Ç—á–∞ - –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ

## –û–±–∑–æ—Ä —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞

–ú–æ–¥—É–ª—å `current_match_handler.py` –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –ø–æ–ª–Ω—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Ç–µ–∫—É—â–∏—Ö –º–∞—Ç—á–µ–π FACEIT CS2 —Å –¥–µ—Ç–∞–ª—å–Ω—ã–º –∞–Ω–∞–ª–∏–∑–æ–º –∫–æ–º–∞–Ω–¥ –∏ –ø—Ä–æ–≥–Ω–æ–∑–æ–º –∏—Å—Ö–æ–¥–∞.

## –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### üîó –í–≤–æ–¥ —Å—Å—ã–ª–∫–∏ –Ω–∞ –º–∞—Ç—á
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤ —Å—Å—ã–ª–æ–∫ FACEIT
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ match_id
- –í–∞–ª–∏–¥–∞—Ü–∏—è —Å—Å—ã–ª–æ–∫

### üìä –ê–Ω–∞–ª–∏–∑ —Å–∏–ª—ã –∫–æ–º–∞–Ω–¥
- –ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∫–∞–∂–¥–æ–≥–æ –∏–≥—Ä–æ–∫–∞ –∏–∑ –æ–±–µ–∏—Ö –∫–æ–º–∞–Ω–¥
- –†–∞—Å—á–µ—Ç —Å—Ä–µ–¥–Ω–µ–≥–æ HLTV 2.1 —Ä–µ–π—Ç–∏–Ω–≥–∞ –∫–æ–º–∞–Ω–¥—ã
- –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –∏–≥—Ä–æ–∫–æ–≤ –Ω–∞ —Å–∏–ª—å–Ω—ã—Ö (HLTV > 1.1) –∏ —Å–ª–∞–±—ã—Ö (HLTV < 0.9)
- –ê–Ω–∞–ª–∏–∑ —Å—Ä–µ–¥–Ω–µ–≥–æ ELO –∏ —É—Ä–æ–≤–Ω—è –∫–æ–º–∞–Ω–¥—ã

### üó∫Ô∏è –ê–Ω–∞–ª–∏–∑ –∫–∞—Ä—Ç—ã
- –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–∞—Ä—Ç—ã –º–∞—Ç—á–∞ –∏–∑ –¥–∞–Ω–Ω—ã—Ö FACEIT
- –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ—Ü–µ–Ω—Ç–∞ –ø–æ–±–µ–¥ –∫–∞–∂–¥–æ–π –∫–æ–º–∞–Ω–¥—ã –Ω–∞ –¥–∞–Ω–Ω–æ–π –∫–∞—Ä—Ç–µ
- –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ª—É—á—à–∏—Ö –∏–≥—Ä–æ–∫–æ–≤ –∫–æ–º–∞–Ω–¥ –Ω–∞ –∫–∞—Ä—Ç–µ
- –û—Ü–µ–Ω–∫–∞ —É—Ä–æ–≤–Ω—è –¥–æ—Å—Ç–æ–≤–µ—Ä–Ω–æ—Å—Ç–∏ –∞–Ω–∞–ª–∏–∑–∞

### üéØ –ü—Ä–æ–≥–Ω–æ–∑ –º–∞—Ç—á–∞
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ñ–∞–≤–æ—Ä–∏—Ç–∞
- –£—Ä–æ–≤–µ–Ω—å —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏ –ø—Ä–æ–≥–Ω–æ–∑–∞ (–≤—ã—Å–æ–∫–∏–π/—Å—Ä–µ–¥–Ω–∏–π/–Ω–∏–∑–∫–∏–π)
- –î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤ –∫–∞–∂–¥–æ–π –∫–æ–º–∞–Ω–¥—ã

## –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã —Å—Å—ã–ª–æ–∫

```
https://www.faceit.com/en/cs2/room/1-abc123-def456-ghi789
https://faceit.com/ru/cs2/room/1-abc123-def456-ghi789
https://www.faceit.com/en/csgo/room/1-abc123-def456-ghi789
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∞–Ω–∞–ª–∏–∑–∞

### 1. –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –º–∞—Ç—á–µ
- –ö–æ–º–∞–Ω–¥—ã-—É—á–∞—Å—Ç–Ω–∏–∫–∏
- –ö–∞—Ä—Ç–∞ (–µ—Å–ª–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞)
- –¢—É—Ä–Ω–∏—Ä –∏ —Ä–µ–≥–∏–æ–Ω
- –°—Ç–∞—Ç—É—Å –º–∞—Ç—á–∞

### 2. –ê–Ω–∞–ª–∏–∑ —Å–∏–ª—ã –∫–æ–º–∞–Ω–¥
```
üë• Team Name
‚îú –°—Ä–µ–¥–Ω–∏–π HLTV: 1.050
‚îú –°—Ä–µ–¥–Ω–∏–π ELO: 1900
‚îú –°—Ä–µ–¥–Ω–∏–π —É—Ä–æ–≤–µ–Ω—å: 7
‚îú –°–∏–ª—å–Ω—ã–µ –∏–≥—Ä–æ–∫–∏ (2):
‚îÇ  ‚Ä¢ Player1 (HLTV: 1.150)
‚îÇ  ‚Ä¢ Player2 (HLTV: 1.120)
‚îî –°–ª–∞–±—ã–µ –∏–≥—Ä–æ–∫–∏ (1):
   ‚Ä¢ Player3 (HLTV: 0.850)
```

### 3. –ê–Ω–∞–ª–∏–∑ –∫–∞—Ä—Ç—ã
```
üó∫Ô∏è –ê–ù–ê–õ–ò–ó –ö–ê–†–¢–´: Mirage

üìä Team1 –Ω–∞ –∫–∞—Ä—Ç–µ:
‚îú –í–∏–Ω—Ä–µ–π—Ç: 65.5%
‚îú –ú–∞—Ç—á–µ–π –Ω–∞ –∫–∞—Ä—Ç–µ: 45
‚îî –ò–≥—Ä–æ–∫–æ–≤ —Å –¥–∞–Ω–Ω—ã–º–∏: 4/5

üìä Team2 –Ω–∞ –∫–∞—Ä—Ç–µ:
‚îú –í–∏–Ω—Ä–µ–π—Ç: 52.3%
‚îú –ú–∞—Ç—á–µ–π –Ω–∞ –∫–∞—Ä—Ç–µ: 38
‚îî –ò–≥—Ä–æ–∫–æ–≤ —Å –¥–∞–Ω–Ω—ã–º–∏: 3/5
```

### 4. –ü—Ä–æ–≥–Ω–æ–∑
```
üéØ –ü–†–û–ì–ù–û–ó

üèÜ –§–∞–≤–æ—Ä–∏—Ç: Team1
üü¢ –£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å: –í—ã—Å–æ–∫–∞—è

üìà –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ Team1:
‚Ä¢ –ü—Ä–µ–≤–æ—Å—Ö–æ–¥—Å—Ç–≤–æ –ø–æ HLTV (+0.085)
‚Ä¢ –ë–æ–ª—å—à–µ —Å–∏–ª—å–Ω—ã—Ö –∏–≥—Ä–æ–∫–æ–≤ (+1)
‚Ä¢ –õ—É—á—à–µ –∏–≥—Ä–∞–µ—Ç –Ω–∞ –∫–∞—Ä—Ç–µ (+13.2%)
```

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### FSM —Å–æ—Å—Ç–æ—è–Ω–∏—è
- `CurrentMatchStates.waiting_for_match_link` - –æ–∂–∏–¥–∞–Ω–∏–µ –≤–≤–æ–¥–∞ —Å—Å—ã–ª–∫–∏

### –ö–ª—é—á–µ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

#### `extract_match_id(url: str) -> Optional[str]`
–ò–∑–≤–ª–µ–∫–∞–µ—Ç match_id –∏–∑ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤ —Å—Å—ã–ª–æ–∫ FACEIT.

#### `calculate_team_strength(players_stats: List[Dict]) -> Dict`
–†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç —Å–∏–ª—É –∫–æ–º–∞–Ω–¥—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∏–≥—Ä–æ–∫–æ–≤:
- –°—Ä–µ–¥–Ω–∏–π HLTV —Ä–µ–π—Ç–∏–Ω–≥
- –°—Ä–µ–¥–Ω–∏–π ELO –∏ —É—Ä–æ–≤–µ–Ω—å
- –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è —Å–∏–ª—å–Ω—ã—Ö/—Å–ª–∞–±—ã—Ö –∏–≥—Ä–æ–∫–æ–≤

#### `analyze_map_performance(players_stats: List[Dict], map_name: str) -> Dict`
–ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∫–æ–º–∞–Ω–¥—ã –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –∫–∞—Ä—Ç–µ:
- –°—Ä–µ–¥–Ω–∏–π –≤–∏–Ω—Ä–µ–π—Ç (–≤–∑–≤–µ—à–µ–Ω–Ω—ã–π –ø–æ –º–∞—Ç—á–∞–º)
- –õ—É—á—à–∏–π/—Ö—É–¥—à–∏–π –∏–≥—Ä–æ–∫ –Ω–∞ –∫–∞—Ä—Ç–µ
- –£—Ä–æ–≤–µ–Ω—å –¥–æ—Å—Ç–æ–≤–µ—Ä–Ω–æ—Å—Ç–∏ –∞–Ω–∞–ª–∏–∑–∞

#### `analyze_current_match(match_id: str) -> Dict`
–û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∞–Ω–∞–ª–∏–∑–∞ –º–∞—Ç—á–∞:
1. –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–µ—Ç–∞–ª–µ–π –º–∞—Ç—á–∞
2. –ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –≤—Å–µ—Ö –∏–≥—Ä–æ–∫–æ–≤
3. –ê–Ω–∞–ª–∏–∑ —Å–∏–ª—ã –∫–æ–º–∞–Ω–¥
4. –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –Ω–∞ –∫–∞—Ä—Ç–µ
5. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø—Ä–æ–≥–Ω–æ–∑–∞

### –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π

#### –û—Å–Ω–æ–≤–Ω—ã–µ callback-–∏:
- `current_match_analysis` - –≤—Ö–æ–¥–Ω–∞—è —Ç–æ—á–∫–∞
- `enter_match_link` - –∑–∞–ø—Ä–æ—Å –≤–≤–æ–¥–∞ —Å—Å—ã–ª–∫–∏
- `show_saved_analysis` - –ø–æ–∫–∞–∑ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞
- `detailed_team_analysis` - –¥–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –∫–æ–º–∞–Ω–¥
- `detailed_map_analysis` - –¥–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –∫–∞—Ä—Ç—ã
- `refresh_current_match` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∞–Ω–∞–ª–∏–∑–∞

### –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ
- –ê–Ω–∞–ª–∏–∑ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –∫—ç—à –Ω–∞ 30 –º–∏–Ω—É—Ç
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –∫–ª—é—á: `current_match_analysis_{user_id}`

### –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø–æ API
- –ó–∞–¥–µ—Ä–∂–∫–∞ 0.2 —Å–µ–∫—É–Ω–¥—ã –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏ –∏–≥—Ä–æ–∫–æ–≤
- –ó–∞–¥–µ—Ä–∂–∫–∞ 1 —Å–µ–∫—É–Ω–¥–∞ –º–µ–∂–¥—É –∫–æ–º–∞–Ω–¥–∞–º–∏
- –°–æ–±–ª—é–¥–µ–Ω–∏–µ rate limits FACEIT API

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ –±–æ—Ç

### 1. –†–æ—É—Ç–µ—Ä –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –≤ `main.py`:
```python
dp.include_router(current_match_router)
```

### 2. –î–æ—Å—Ç—É–ø–µ–Ω —á–µ—Ä–µ–∑ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é:
```python
builder.button(text="üîç –ê–Ω–∞–ª–∏–∑ —Ç–µ–∫—É—â–µ–≥–æ –º–∞—Ç—á–∞", callback_data="current_match_analysis")
```

### 3. –ò–º–ø–æ—Ä—Ç –≤ `bot/handlers/__init__.py`:
```python
from .current_match_handler import router as current_match_router
```

## –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç "üîç –ê–Ω–∞–ª–∏–∑ —Ç–µ–∫—É—â–µ–≥–æ –º–∞—Ç—á–∞" –≤ –≥–ª–∞–≤–Ω–æ–º –º–µ–Ω—é
2. –í—ã–±–∏—Ä–∞–µ—Ç "üîó –í–≤–µ—Å—Ç–∏ —Å—Å—ã–ª–∫—É –Ω–∞ –º–∞—Ç—á"
3. –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å—Å—ã–ª–∫—É –Ω–∞ –º–∞—Ç—á FACEIT
4. –ü–æ–ª—É—á–∞–µ—Ç –ø–æ–ª–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —á–µ—Ä–µ–∑ 1-2 –º–∏–Ω—É—Ç—ã
5. –ú–æ–∂–µ—Ç –ø—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –¥–µ—Ç–∞–ª—å–Ω—ã–µ —Ä–∞–∑–¥–µ–ª—ã –ø–æ –∫–æ–º–∞–Ω–¥–∞–º –∏ –∫–∞—Ä—Ç–µ
6. –ê–Ω–∞–ª–∏–∑ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –∏ –¥–æ—Å—Ç—É–ø–µ–Ω –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞

## –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

### –í–∞–ª–∏–¥–∞—Ü–∏—è —Å—Å—ã–ª–æ–∫
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∞ —Å—Å—ã–ª–∫–∏
- –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ match_id

### –û—à–∏–±–∫–∏ API
- –ú–∞—Ç—á –Ω–µ –Ω–∞–π–¥–µ–Ω
- –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö –æ–± –∏–≥—Ä–æ–∫–∞—Ö
- –ü—Ä–µ–≤—ã—à–µ–Ω–∏–µ –ª–∏–º–∏—Ç–æ–≤ API

### –°–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö
- –ü–æ–Ω—è—Ç–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –ø–æ —Ä–µ—à–µ–Ω–∏—é –ø—Ä–æ–±–ª–µ–º

## –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∞–Ω–∞–ª–∏–∑–∞
- –û–±—ã—á–Ω–æ 1-2 –º–∏–Ω—É—Ç—ã –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞
- –ó–∞–≤–∏—Å–∏—Ç –æ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ API FACEIT
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —É—Å–∫–æ—Ä—è–µ—Ç –ø–æ–≤—Ç–æ—Ä–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è
- –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –≥–¥–µ –≤–æ–∑–º–æ–∂–Ω–æ
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
- –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ API –ª–∏–º–∏—Ç–æ–≤

## –ë—É–¥—É—â–∏–µ —É–ª—É—á—à–µ–Ω–∏—è

1. **–ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ç—É—Ä–Ω–∏—Ä–Ω—ã—Ö –º–∞—Ç—á–µ–π** - –∞–Ω–∞–ª–∏–∑ playoff/qualifier –º–∞—Ç—á–µ–π
2. **–ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ** - —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º–∏ –≤—Å—Ç—Ä–µ—á–∞–º–∏ –∫–æ–º–∞–Ω–¥
3. **Live –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è** - –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ —Ö–æ–¥–µ –º–∞—Ç—á–∞
4. **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å—Ç—Ä–∞—Ç–µ–≥–∏–π** - –∞–Ω–∞–ª–∏–∑ –≤—ã–±–æ—Ä–∞ —Å—Ç–æ—Ä–æ–Ω, —ç–∫–æ–Ω–æ–º–∏–∫–∏
5. **–ú–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ** - —É–ª—É—á—à–µ–Ω–∏–µ —Ç–æ—á–Ω–æ—Å—Ç–∏ –ø—Ä–æ–≥–Ω–æ–∑–æ–≤