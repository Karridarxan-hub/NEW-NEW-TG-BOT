# üöÄ GitHub Actions –ê–≤—Ç–æ–¥–µ–ø–ª–æ–π - –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ

## üìã –ü–æ–ª–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –¥–µ–ø–ª–æ—è —á–µ—Ä–µ–∑ GitHub Actions

### ‚úÖ –ß–¢–û –£–ñ–ï –ì–û–¢–û–í–û:
- ‚úÖ GitHub Actions workflow —Å–æ–∑–¥–∞–Ω
- ‚úÖ –°–∫—Ä–∏–ø—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –í–ü–° –≥–æ—Ç–æ–≤
- ‚úÖ –í–∞—à SSH –∫–ª—é—á –ø–æ–ª—É—á–µ–Ω
- ‚úÖ –ü—Ä–æ–¥–∞–∫—à–Ω —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –Ω–∞—Å—Ç—Ä–æ–µ–Ω

---

## üîß –®–ê–ì–ò –ù–ê–°–¢–†–û–ô–ö–ò

### 1. üñ•Ô∏è –ù–ê–°–¢–†–û–ô–ö–ê –í–ü–°

#### –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ –í–ü–° –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ:

```bash
# –°–∫–∞—á–∞—Ç—å —Å–∫—Ä–∏–ø—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
curl -o setup-vps.sh https://raw.githubusercontent.com/Karridarxan-hub/NEW-NEW-TG-BOT/master/scripts/setup-vps.sh

# –°–¥–µ–ª–∞—Ç—å –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º
chmod +x setup-vps.sh

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫—É
sudo ./setup-vps.sh
```

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç —Å–∫—Ä–∏–ø—Ç:**
- –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç Docker –∏ Docker Compose
- –°–æ–∑–¥–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è `faceit` –¥–ª—è –¥–µ–ø–ª–æ—è
- –ö–ª–æ–Ω–∏—Ä—É–µ—Ç —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –≤ `/opt/faceit-bot`
- –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç SSH, firewall –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- –°–æ–∑–¥–∞–µ—Ç systemd —Å–µ—Ä–≤–∏—Å

---

### 2. üîë –°–û–ó–î–ê–ù–ò–ï SSH –ö–õ–Æ–ß–ï–ô

#### –ù–∞ –≤–∞—à–µ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ —Å–æ–∑–¥–∞–π—Ç–µ –ù–û–í–´–ô SSH –∫–ª—é—á –¥–ª—è –¥–µ–ø–ª–æ—è:

```bash
# –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π SSH –∫–ª—é—á —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ –¥–ª—è –¥–µ–ø–ª–æ—è
ssh-keygen -t rsa -b 4096 -f ~/.ssh/faceit_deploy -N ""

# –ü–æ–∫–∞–∑–∞—Ç—å –ø—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á (–¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–∞ –í–ü–°)
cat ~/.ssh/faceit_deploy.pub

# –ü–æ–∫–∞–∑–∞—Ç—å –ø—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á (–¥–ª—è GitHub Secrets)
cat ~/.ssh/faceit_deploy
```

#### –î–æ–±–∞–≤–∏—Ç—å –ø—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á –Ω–∞ –í–ü–°:

```bash
# –ù–∞ –í–ü–° –¥–æ–±–∞–≤–∏—Ç—å –ø—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á
sudo -u faceit nano /home/faceit/.ssh/authorized_keys

# –í—Å—Ç–∞–≤–∏—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ ~/.ssh/faceit_deploy.pub
# –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏ –≤—ã–π—Ç–∏ (Ctrl+X, Y, Enter)

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∞–≤–∞
sudo -u faceit chmod 600 /home/faceit/.ssh/authorized_keys
sudo -u faceit chmod 700 /home/faceit/.ssh
```

---

### 3. üîê –ù–ê–°–¢–†–û–ô–ö–ê GITHUB SECRETS

#### –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –≤–∞—à —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –Ω–∞ GitHub:
üëâ https://github.com/Karridarxan-hub/NEW-NEW-TG-BOT/settings/secrets/actions

#### –î–æ–±–∞–≤—å—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ secrets:

| Secret Name | Value | –û–ø–∏—Å–∞–Ω–∏–µ |
|------------|-------|----------|
| `VPS_HOST` | `–≤–∞—à_ip_–∞–¥—Ä–µ—Å_–≤–ø—Å` | IP –∞–¥—Ä–µ—Å –∏–ª–∏ –¥–æ–º–µ–Ω –í–ü–° |
| `VPS_USER` | `faceit` | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞ –í–ü–° |
| `VPS_PORT` | `22` | SSH –ø–æ—Ä—Ç (–æ–±—ã—á–Ω–æ 22) |
| `VPS_SSH_KEY` | `–ø—Ä–∏–≤–∞—Ç–Ω—ã–π_–∫–ª—é—á` | –°–æ–¥–µ—Ä–∂–∏–º–æ–µ ~/.ssh/faceit_deploy |

#### üîç –ö–ê–ö –î–û–ë–ê–í–ò–¢–¨ SECRETS:

1. **–û—Ç–∫—Ä–æ–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π** ‚Üí Settings ‚Üí Secrets and variables ‚Üí Actions
2. **–ù–∞–∂–º–∏—Ç–µ "New repository secret"**
3. **–î–æ–±–∞–≤—å—Ç–µ –∫–∞–∂–¥—ã–π secret:**

**VPS_HOST:**
```
# –í–∞—à IP –∞–¥—Ä–µ—Å –í–ü–°
123.456.789.123
```

**VPS_USER:**
```
faceit
```

**VPS_PORT:**
```
22
```

**VPS_SSH_KEY:**
```
-----BEGIN RSA PRIVATE KEY-----
(—Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –ø—Ä–∏–≤–∞—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞ ~/.ssh/faceit_deploy)
-----END RSA PRIVATE KEY-----
```

‚ö†Ô∏è **–í–ê–ñ–ù–û**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ù–û–í–´–ô –∫–ª—é—á –∏–∑ —Ñ–∞–π–ª–∞ `VPS_SETUP_NEW_KEYS.md`!

---

### 4. üß™ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï –ê–í–¢–û–î–ï–ü–õ–û–Ø

#### –°–æ–∑–¥–∞–¥–∏–º —Ç–µ—Å—Ç–æ–≤—ã–π –∫–æ–º–º–∏—Ç:

```bash
# –í –ª–æ–∫–∞–ª—å–Ω–æ–π –ø–∞–ø–∫–µ —Å –ø—Ä–æ–µ–∫—Ç–æ–º
git add .
git commit -m "üöÄ –¢–µ—Å—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –¥–µ–ø–ª–æ—è —á–µ—Ä–µ–∑ GitHub Actions"
git push origin master
```

#### –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –¥–µ–ø–ª–æ—è:

1. **–û—Ç–∫—Ä–æ–π—Ç–µ GitHub** ‚Üí Actions tab –≤–∞—à–µ–≥–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
2. **–ù–∞–π–¥–∏—Ç–µ –∑–∞–ø—É—â–µ–Ω–Ω—ã–π workflow** "üöÄ Production Deploy"
3. **–ö–ª–∏–∫–Ω–∏—Ç–µ –Ω–∞ –Ω–µ–≥–æ** –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –ª–æ–≥–æ–≤ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

#### –ù–∞ –í–ü–° –º–æ–∂–µ—Ç–µ —Ç–∞–∫–∂–µ —Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏:

```bash
# –õ–æ–≥–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
cd /opt/faceit-bot
docker-compose logs -f faceit-bot

# –°—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–æ–≤
docker-compose ps

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤
docker stats
```

---

### 5. üîÑ –ö–ê–ö –†–ê–ë–û–¢–ê–ï–¢ –ê–í–¢–û–î–ï–ü–õ–û–ô

#### –ü—Ä–∏ –∫–∞–∂–¥–æ–º `git push origin master`:

1. **GitHub Actions –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è** –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
2. **–ü–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ –í–ü–°** –ø–æ SSH
3. **–û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Å—Ç–∞—Ä—ã–µ —Å–µ—Ä–≤–∏—Å—ã**
4. **–°–∫–∞—á–∏–≤–∞–µ—Ç –Ω–æ–≤—ã–π –∫–æ–¥** (`git pull`)
5. **–°–æ–∑–¥–∞–µ—Ç backup** —Ç–µ–∫—É—â–µ–π –≤–µ—Ä—Å–∏–∏
6. **–ü–µ—Ä–µ—Å–æ–±–∏—Ä–∞–µ—Ç Docker –æ–±—Ä–∞–∑—ã**
7. **–ó–∞–ø—É—Å–∫–∞–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã**
8. **–ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å**
9. **–ü—Ä–∏ –æ—à–∏–±–∫–µ - –¥–µ–ª–∞–µ—Ç rollback**

#### –í—Ä–µ–º—è –¥–µ–ø–ª–æ—è: ~3-5 –º–∏–Ω—É—Ç

---

## üìä –ú–û–ù–ò–¢–û–†–ò–ù–ì –ò –£–ü–†–ê–í–õ–ï–ù–ò–ï

### –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –Ω–∞ –í–ü–°:

```bash
# –°—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–æ–≤
cd /opt/faceit-bot && docker-compose ps

# –õ–æ–≥–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
docker-compose logs -f faceit-bot

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –±–æ—Ç–∞ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
docker-compose restart faceit-bot

# –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—Ä—É—á–Ω—É—é (–µ—Å–ª–∏ Actions –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç)
git pull origin master
./scripts/deploy.sh prod --rebuild

# –ü—Ä–æ—Å–º–æ—Ç—Ä –±—ç–∫–∞–ø–æ–≤
ls -la /opt/backups/

# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ –±—ç–∫–∞–ø–∞ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
cd /opt/faceit-bot
tar -xzf /opt/backups/backup_YYYYMMDD_HHMMSS.tar.gz
docker-compose up -d
```

### –õ–æ–≥–∏ GitHub Actions:

- üìÅ **–í—Å–µ –¥–µ–ø–ª–æ–∏**: https://github.com/Karridarxan-hub/NEW-NEW-TG-BOT/actions
- üìä **–°—Ç–∞—Ç—É—Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ**: Badge –≤ README
- üìß **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è**: GitHub –ø—Ä–∏—à–ª–µ—Ç email –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö

---

## üö® TROUBLESHOOTING

### –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:

#### 1. **"Permission denied (publickey)"**
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å SSH –∫–ª—é—á –Ω–∞ –í–ü–°
sudo -u faceit cat /home/faceit/.ssh/authorized_keys

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∞–≤–∞
sudo -u faceit chmod 600 /home/faceit/.ssh/authorized_keys
sudo -u faceit chmod 700 /home/faceit/.ssh
```

#### 2. **"Docker not found"**
```bash
# –ü–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Docker
curl -fsSL https://get.docker.com | sh
sudo usermod -aG docker faceit
```

#### 3. **"Port already in use"**
```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ä—ã–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
cd /opt/faceit-bot
docker-compose down --remove-orphans
docker system prune -f
```

#### 4. **"Health check failed"**
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏
docker-compose logs faceit-bot

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å .env —Ñ–∞–π–ª
cat .env

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–æ–∫–µ–Ω –±–æ—Ç–∞
curl -s "https://api.telegram.org/bot${BOT_TOKEN}/getMe"
```

---

## ‚úÖ –ü–†–û–í–ï–†–ö–ê –ì–û–¢–û–í–ù–û–°–¢–ò

### –ß–µ–∫-–ª–∏—Å—Ç –ø–µ—Ä–µ–¥ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º:

- [ ] –í–ü–° –Ω–∞—Å—Ç—Ä–æ–µ–Ω —Å–∫—Ä–∏–ø—Ç–æ–º `setup-vps.sh`
- [ ] SSH –∫–ª—é—á–∏ —Å–æ–∑–¥–∞–Ω—ã –∏ –¥–æ–±–∞–≤–ª–µ–Ω—ã
- [ ] GitHub Secrets –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã (4 —à—Ç—É–∫–∏)
- [ ] –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –∏–º–µ–µ—Ç workflow —Ñ–∞–π–ª
- [ ] –î–æ—Å—Ç—É–ø –∫ –í–ü–° –ø–æ SSH —Ä–∞–±–æ—Ç–∞–µ—Ç

### –¢–µ—Å—Ç –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏:

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å SSH –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
ssh -i ~/.ssh/faceit_deploy faceit@–≤–∞—à_ip_–≤–ø—Å "echo 'SSH —Ä–∞–±–æ—Ç–∞–µ—Ç!'"

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Docker –Ω–∞ –í–ü–°
ssh -i ~/.ssh/faceit_deploy faceit@–≤–∞—à_ip_–≤–ø—Å "docker --version"

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –Ω–∞ –í–ü–°
ssh -i ~/.ssh/faceit_deploy faceit@–≤–∞—à_ip_–≤–ø—Å "cd /opt/faceit-bot && git status"
```

---

## üéâ –ì–û–¢–û–í–û!

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–µ–ø–ª–æ–π –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Ç–∞–∫:

```
üìù –ö–æ–º–º–∏—Ç ‚Üí üîÑ GitHub Actions ‚Üí üñ•Ô∏è –í–ü–° ‚Üí ü§ñ –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –±–æ—Ç!
```

**–ö–æ–Ω—Ç–∞–∫—Ç—ã –¥–ª—è –ø–æ–º–æ—â–∏:**
- Telegram: @karriDD  
- Issues: https://github.com/Karridarxan-hub/NEW-NEW-TG-BOT/issues

**–í–µ—Ä—Å–∏—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏:** v2.1.3 üöÄ