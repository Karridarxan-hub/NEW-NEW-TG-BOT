# Form Analysis Handler

## –û–±–∑–æ—Ä
–ú–æ–¥—É–ª—å `form_analysis_handler.py` –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –∞–Ω–∞–ª–∏–∑–∞ —Ñ–æ—Ä–º—ã –∏–≥—Ä–æ–∫–∞ CS2 –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ FACEIT. –ü–æ–∑–≤–æ–ª—è–µ—Ç —Å—Ä–∞–≤–Ω–∏–≤–∞—Ç—å –∏–≥—Ä–æ–≤—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –º–µ–∂–¥—É –¥–≤—É–º—è –≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –ø–µ—Ä–∏–æ–¥–∞–º–∏.

## –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª

### –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
1. **–ê–Ω–∞–ª–∏–∑ —Ñ–æ—Ä–º—ã 10 vs 10** - —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö 10 –º–∞—Ç—á–µ–π —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º–∏ 10
2. **–ê–Ω–∞–ª–∏–∑ —Ñ–æ—Ä–º—ã 20 vs 20** - —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö 20 –º–∞—Ç—á–µ–π —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º–∏ 20  
3. **–ê–Ω–∞–ª–∏–∑ —Ñ–æ—Ä–º—ã 50 vs 50** - —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö 50 –º–∞—Ç—á–µ–π —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º–∏ 50
4. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –≤–≤–æ–¥** - –≤—ã–±–æ—Ä –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –º–∞—Ç—á–µ–π (–æ—Ç 5 –¥–æ 100)

### –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏

#### –ë–∞–∑–æ–≤—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ (–≤—Å–µ–≥–¥–∞ –¥–æ—Å—Ç—É–ø–Ω—ã):
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–±–µ–¥ –∏ –≤–∏–Ω—Ä–µ–π—Ç
- –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–∞—Ç—á–µ–π –≤ –∫–∞–∂–¥–æ–º –ø–µ—Ä–∏–æ–¥–µ

#### –î–µ—Ç–∞–ª—å–Ω—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ (–ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ –¥–∞–Ω–Ω—ã—Ö):
- –°—Ä–µ–¥–Ω–∏–π –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å –∫–∏–ª–æ–≤, —Å–º–µ—Ä—Ç–µ–π, –∞—Å—Å–∏—Å—Ç–æ–≤
- –°—Ä–µ–¥–Ω–∏–π K/D –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç
- –ü—Ä–æ—Ü–µ–Ω—Ç —É–±–∏–π—Å—Ç–≤ –≤ –≥–æ–ª–æ–≤—É
- ADR (Average Damage per Round)
- KAST –ø—Ä–æ—Ü–µ–Ω—Ç
- –†–µ–π—Ç–∏–Ω–≥ –∏–≥—Ä–æ–∫–∞
- –°—Ä–µ–¥–Ω–∏–π –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å —Ñ–ª–µ—à-–∞—Å—Å–∏—Å—Ç–æ–≤
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–µ—Ä–≤—ã—Ö —É–±–∏–π—Å—Ç–≤ –∏ —Å–º–µ—Ä—Ç–µ–π

### –§–æ—Ä–º–∞—Ç –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞ –ø–µ—Ä–≤—ã–π –ø–µ—Ä–∏–æ–¥ (–ø–æ—Å–ª–µ–¥–Ω–∏–µ N –º–∞—Ç—á–µ–π)
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞ –≤—Ç–æ—Ä–æ–π –ø–µ—Ä–∏–æ–¥ (–ø—Ä–µ–¥—ã–¥—É—â–∏–µ N –º–∞—Ç—á–µ–π)
- –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –ø–æ–∫–∞–∑–æ–º –∏–∑–º–µ–Ω–µ–Ω–∏–π (üìà —É–ª—É—á—à–µ–Ω–∏–µ / üìâ —É—Ö—É–¥—à–µ–Ω–∏–µ / ‚û°Ô∏è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)
- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–∞—á–µ—Å—Ç–≤–µ –¥–∞–Ω–Ω—ã—Ö (–ø—Ä–æ—Ü–µ–Ω—Ç –º–∞—Ç—á–µ–π —Å –¥–µ—Ç–∞–ª—å–Ω–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π)

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è

### FSM —Å–æ—Å—Ç–æ—è–Ω–∏—è
- `FormAnalysisStates.waiting_for_custom_count` - –æ–∂–∏–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –≤–≤–æ–¥–∞

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

#### `show_form_analysis_menu(callback, state)`
–û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é –∞–Ω–∞–ª–∏–∑–∞ —Ñ–æ—Ä–º—ã —Å –≤—ã–±–æ—Ä–æ–º –ø–µ—Ä–∏–æ–¥–æ–≤.

#### `analyze_form_fixed(callback, state)`
–ê–Ω–∞–ª–∏–∑ —Ñ–æ—Ä–º—ã –¥–ª—è –ø—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö –ø–µ—Ä–∏–æ–¥–æ–≤ (10, 20, 50 –º–∞—Ç—á–µ–π).

#### `ask_custom_form_count(callback, state)`
–ó–∞–ø—Ä–æ—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –º–∞—Ç—á–µ–π –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞.

#### `process_custom_form_count(message, state)`
–û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –≤–≤–æ–¥–∞ —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π (5-100 –º–∞—Ç—á–µ–π).

#### `perform_form_analysis(callback, match_count)`
–û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∞–Ω–∞–ª–∏–∑–∞ —Ñ–æ—Ä–º—ã:
- –ü–æ–ª—É—á–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ –º–∞—Ç—á–µ–π
- –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ –ø–µ—Ä–∏–æ–¥—ã
- –ê–Ω–∞–ª–∏–∑ –∫–∞–∂–¥–æ–≥–æ –ø–µ—Ä–∏–æ–¥–∞
- –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞

#### `analyze_matches_period(matches, faceit_id, period_name)`
–ê–Ω–∞–ª–∏–∑ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∑–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–π –ø–µ—Ä–∏–æ–¥:
- –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –º–∞—Ç—á–µ–π
- –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–µ—Ç–∞–ª—å–Ω–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
- –†–∞—Å—á–µ—Ç —Å—Ä–µ–¥–Ω–∏—Ö –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π
- –†–∞—Å—á–µ—Ç —Ä–µ–π—Ç–∏–Ω–≥–∞ –∏–≥—Ä–æ–∫–∞

### –ê–ª–≥–æ—Ä–∏—Ç–º —Ä–∞—Å—á–µ—Ç–∞ —Ä–µ–π—Ç–∏–Ω–≥–∞ –∏–≥—Ä–æ–∫–∞
–ò—Å–ø–æ–ª—å–∑—É–µ—Ç —É–ø—Ä–æ—â–µ–Ω–Ω—É—é —Ñ–æ—Ä–º—É–ª—É:
```
–†–µ–π—Ç–∏–Ω–≥ = 0.0073*KAST + 0.3591*KPR - 0.5329*DPR + 0.2372*Impact + 0.0032*ADR + 0.1587
```

–ì–¥–µ:
- KAST - –ø—Ä–æ—Ü–µ–Ω—Ç —Ä–∞—É–Ω–¥–æ–≤ —Å –≤–∫–ª–∞–¥–æ–º –≤ –∫–æ–º–∞–Ω–¥—É
- KPR - —É–±–∏–π—Å—Ç–≤–∞ –∑–∞ —Ä–∞—É–Ω–¥
- DPR - —Å–º–µ—Ä—Ç–∏ –∑–∞ —Ä–∞—É–Ω–¥  
- Impact - –≤–ª–∏—è–Ω–∏–µ –Ω–∞ –∏–≥—Ä—É (—É–ø—Ä–æ—â–µ–Ω–Ω–æ = KPR)
- ADR - —Å—Ä–µ–¥–Ω–∏–π —É—Ä–æ–Ω –∑–∞ —Ä–∞—É–Ω–¥

## –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

### –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏–≤—è–∑–∫–∏ FACEIT –ø—Ä–æ—Ñ–∏–ª—è
- –í–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –º–∞—Ç—á–µ–π
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –≤–≤–æ–¥–∞ (5-100)

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–º–µ–Ω—å—à–µ–Ω–∏–µ –ø–µ—Ä–∏–æ–¥–∞ –ø—Ä–∏ –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–µ –º–∞—Ç—á–µ–π
- –ò–Ω—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –æ –ø—Ä–æ—Ü–µ–Ω—Ç–µ –º–∞—Ç—á–µ–π —Å –¥–µ—Ç–∞–ª—å–Ω–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π
- Graceful degradation –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –¥–µ—Ç–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- –û—à–∏–±–∫–∏ API –∑–∞–ø—Ä–æ—Å–æ–≤
- –ü—Ä–æ–±–ª–µ–º—ã —Å –ø–æ–ª—É—á–µ–Ω–∏–µ–º –¥–µ—Ç–∞–ª—å–Ω–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–∞—á–µ—Å—Ç–≤–µ –¥–∞–Ω–Ω—ã—Ö

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

### –†–æ—É—Ç–µ—Ä –ø–æ–¥–∫–ª—é—á–µ–Ω –≤:
- `bot/handlers/__init__.py` –∫–∞–∫ `form_analysis_router`
- `main.py` –≤ —Ñ—É–Ω–∫—Ü–∏–∏ `setup_routers()`

### –ö–ª–∞–≤–∏–∞—Ç—É—Ä—ã:
- –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é: –∫–Ω–æ–ø–∫–∞ "üìà –ê–Ω–∞–ª–∏–∑ —Ñ–æ—Ä–º—ã" (`callback_data="form_analysis"`)
- –ú–µ–Ω—é –∞–Ω–∞–ª–∏–∑–∞: `get_form_analysis_keyboard()`

### –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
- `storage` - –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è FACEIT ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `faceit_client` - –¥–ª—è API –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ FACEIT
- `keyboards` - –¥–ª—è –∫–ª–∞–≤–∏–∞—Ç—É—Ä –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
- `aiogram.fsm` - –¥–ª—è —Å–æ—Å—Ç–æ—è–Ω–∏–π FSM

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ë—ã—Å—Ç—Ä—ã–π –∞–Ω–∞–ª–∏–∑:
1. –ù–∞–∂–∞—Ç—å "üìà –ê–Ω–∞–ª–∏–∑ —Ñ–æ—Ä–º—ã" –≤ –≥–ª–∞–≤–Ω–æ–º –º–µ–Ω—é
2. –í—ã–±—Ä–∞—Ç—å "üîü 10 –º–∞—Ç—á–µ–π vs 10 –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö"
3. –ü–æ–ª—É—á–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å—Ä–∞–≤–Ω–µ–Ω–∏—è

### –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑:
1. –ù–∞–∂–∞—Ç—å "üìà –ê–Ω–∞–ª–∏–∑ —Ñ–æ—Ä–º—ã" –≤ –≥–ª–∞–≤–Ω–æ–º –º–µ–Ω—é  
2. –í—ã–±—Ä–∞—Ç—å "‚úèÔ∏è –í–≤–µ—Å—Ç–∏ –≤—Ä—É—á–Ω—É—é"
3. –í–≤–µ—Å—Ç–∏ —á–∏—Å–ª–æ –æ—Ç 5 –¥–æ 100
4. –ü–æ–ª—É—á–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å—Ä–∞–≤–Ω–µ–Ω–∏—è

–ú–æ–¥—É–ª—å –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –ø–æ–ª–Ω—ã–π —Ü–∏–∫–ª –∞–Ω–∞–ª–∏–∑–∞ —Ñ–æ—Ä–º—ã –∏–≥—Ä–æ–∫–∞ —Å –¥–µ—Ç–∞–ª—å–Ω–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π –∏ —É–¥–æ–±–Ω—ã–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º.